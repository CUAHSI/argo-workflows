metadata:
  generateName: transfer-data-
  namespace: workflows
spec:
  templates:
    - name: transfer-data-template
      inputs: {}
      outputs: {}
      metadata: {}
      steps:
        - - name: transfer-data
            template: transfer-data
            arguments:
              parameters:
                - name: input-path
                  value: '{{workflow.parameters.input-path}}'
                - name: input-bucket
                  value: '{{workflow.parameters.input-bucket}}'
                - name: output-path
                  value: '{{workflow.parameters.output-path}}'
                - name: output-bucket
                  value: '{{workflow.parameters.output-bucket}}'
    - name: transfer-data
      inputs:
        parameters:
          - name: input-path
          - name: input-bucket
          - name: output-path
          - name: output-bucket
        artifacts:
          - name: input-data
            path: /srv/input
            s3:
              endpoint: api.minio.cuahsi.io
              bucket: '{{inputs.parameters.input-bucket}}'
              accessKeySecret:
                name: minio-credentials
                key: accessKey
              secretKeySecret:
                name: minio-credentials
                key: secretKey
              key: '{{inputs.parameters.input-path}}'
      outputs:
        artifacts:
          - name: output-data
            path: /srv/output
            s3:
              endpoint: api.minio.cuahsi.io
              bucket: '{{inputs.parameters.output-bucket}}'
              accessKeySecret:
                name: minio-credentials
                key: accessKey
              secretKeySecret:
                name: minio-credentials
                key: secretKey
              key: '{{inputs.parameters.output-path}}'
      metadata: {}
      container:
        name: ''
        image: cuahsi/parflow-subset-argo:v1
        command:
          - cp
        args:
          - -r
          - /srv/input/
          - /srv/output/
        resources:
          requests:
            ephemeral-storage: 50Gi
  entrypoint: transfer-data
  arguments:
    parameters:
      - name: input-path
        value: domain_data/nwm.v3.0.10
      - name: input-bucket
        value: scratch
      - name: output-path
        value: nwm.v3.0.10.gz
      - name: output-bucket
        value: subsetter-static-input
  templateDefaults:
    inputs: {}
    outputs: {}
    metadata: {}
    retryStrategy:
      limit: '2'
    timeout: 600s
